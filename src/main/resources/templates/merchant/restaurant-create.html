<!DOCTYPE html>
<html lang="zh-Hant" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>商家新增餐廳</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .time-row{display:flex;gap:.5rem;align-items:center;margin-bottom:.5rem}
    .time-row .form-control,.time-row .form-select{width:auto}
  </style>
</head>
<body class="container py-4">
  <div th:replace="~{layout/navbar}"></div>

  <h2 class="mb-4">商家新增餐廳</h2>

  <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
  <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
  <div th:if="${msg}" class="alert alert-info" th:text="${msg}"></div>

  <!-- ★★ 關鍵：改成商家端點 ★★ -->
  <form th:action="@{/merchant/restaurant/create}" method="post" enctype="multipart/form-data">

    <div class="mb-3">
      <label class="form-label">店名</label>
      <input type="text" class="form-control" name="name" required>
    </div>

    <div class="mb-3">
      <label class="form-label">地址</label>
      <input type="text" class="form-control" name="address" required>
    </div>

    <div class="mb-3">
      <label class="form-label">電話</label>
      <input type="text" class="form-control" name="phone">
    </div>

    <div class="mb-3">
      <label class="form-label">縣市</label>
      <select class="form-select" name="county" required>
        <option value="" selected disabled>請選擇</option>
        <option>台北市</option><option>新北市</option><option>基隆市</option>
        <option>桃園市</option><option>新竹市</option><option>新竹縣</option>
        <option>苗栗縣</option><option>台中市</option><option>彰化縣</option>
        <option>南投縣</option><option>雲林縣</option><option>嘉義市</option>
        <option>嘉義縣</option><option>台南市</option><option>高雄市</option>
        <option>屏東縣</option><option>台東縣</option><option>花蓮縣</option>
        <option>宜蘭縣</option><option>澎湖縣</option><option>金門縣</option>
        <option>連江縣</option>
      </select>
    </div>

    <div class="mb-3">
      <label class="form-label">分類（可複選）</label><br>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="type" value="早餐">
        <label class="form-check-label">早餐</label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="checkbox" name="type" value="小吃">
        <label class="form-check-label">小吃</label>
      </div>
      <!-- 其餘分類可自行補充 -->
    </div>

    <div class="mb-3">
      <label class="form-label">關鍵字（空白分隔）</label>
      <input type="text" class="form-control" name="keywords" placeholder="小籠包 餡餅 排隊">
    </div>

    <div class="mb-3">
      <label class="form-label">店家照片（最多 5 張）</label>
      <input type="file" class="form-control" name="photos" multiple accept="image/*">
      <div class="form-text">單張 ≤ 15MB，總共 ≤ 50MB。</div>
    </div>

    <!-- 營業時間（可選填） -->
    <div class="mb-3">
      <label class="form-label">每週營業時間（可選填）</label>
      <div id="weekly-container">
        <div class="time-row">
          <select name="dayOfWeek" class="form-select">
            <option value="MONDAY">週一</option>
            <option value="TUESDAY">週二</option>
            <option value="WEDNESDAY">週三</option>
            <option value="THURSDAY">週四</option>
            <option value="FRIDAY">週五</option>
            <option value="SATURDAY">週六</option>
            <option value="SUNDAY">週日</option>
          </select>
          <label>開</label><input type="time" name="openTime" class="form-control">
          <label>關</label><input type="time" name="closeTime" class="form-control">
          <div class="form-check ms-1">
            <input class="form-check-input" type="checkbox" name="closedAllDay" value="true" onchange="toggleRow(this)">
            <label class="form-check-label">公休</label>
          </div>
          <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeRow(this)">刪除</button>
        </div>
      </div>
      <button type="button" class="btn btn-outline-secondary btn-sm mt-2" onclick="addRow()">+ 增加一天</button>
    </div>

    <button type="submit" class="btn btn-primary">送出審核</button>
  </form>

<script>
function addRow(){
  const container=document.getElementById('weekly-container');
  const tpl=container.querySelector('.time-row');
  const clone=tpl.cloneNode(true);
  clone.querySelectorAll('input').forEach(i=>{ if(i.type==='time'){ i.value=''; i.disabled=false; } else if(i.type==='checkbox'){ i.checked=false; }});
  container.appendChild(clone);
}
function removeRow(btn){
  const container=document.getElementById('weekly-container');
  const rows=container.querySelectorAll('.time-row');
  if(rows.length>1) btn.closest('.time-row').remove();
}
function toggleRow(cb){
  const row=cb.closest('.time-row');
  const times=row.querySelectorAll('input[type=time]');
  if(cb.checked){ times.forEach(i=>{i.value='';i.disabled=true;}); }
  else{ times.forEach(i=>i.disabled=false); }
}
</script>
</body>
</html>
